cat << "EOF" > run.sh
#!/data/data/com.termux/files/usr/bin/bash

set -e

echo "=== Preparing Termux (clean & stable) ==="

export DEBIAN_FRONTEND=noninteractive

pkg clean
pkg update -y
pkg upgrade -y -o Dpkg::Options::="--force-confold"

pkg install -y \
git curl \
clang make cmake automake autoconf libtool pkg-config \
libcurl libjansson \
openssl openssl-dev \
screen

echo "=== Cleaning old miner ==="
killall screen 2>/dev/null || true
killall cpuminer 2>/dev/null || true
rm -rf ~/hp

echo "=== Download source ==="
git clone https://github.com/amirul5656/hp.git
cd hp

chmod +x build-armv8.sh autogen.sh configure
./build-armv8.sh

cd ~

THREADS=$(nproc)

echo "=== Starting miner with $THREADS threads ==="

screen -dmS miner ./hp/cpuminer \
-a yespowerADVC \
-o stratum+tcp://yespowerADVC.sea.mine.zpool.ca:6248 \
-u ltc1q682mxnytl67x3gdw8eezxpuq4pehz5qhax4ls5 \
-p c=LTC,zap=ADVC \
-t $THREADS

echo ""
echo "=============================="
echo "âœ… Miner RUNNING"
echo "Threads : $THREADS"
echo "View    : screen -r miner"
echo "Detach  : CTRL+A lalu D"
echo "Stop    : killall cpuminer"
echo "=============================="
EOF

chmod +x run.sh
bash run.sh
